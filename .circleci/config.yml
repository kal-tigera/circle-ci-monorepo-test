version: 2.1

orbs:
  path-filtering: circleci/path-filtering@1.1.0

executors:
  default:
    docker:
      - image: circleci/node:14

jobs:
  # Job for Project 1
  build_project1:
    executor: default
    steps:
      - checkout
      - run: echo "Building Project 1"

  # Job for Project 2
  build_project2:
    executor: default
    steps:
      - checkout
      - run: echo "Building Project 2"

  # Job for Shared Folder
  build_shared:
    executor: default
    steps:
      - checkout
      - run: echo "Building Shared Dependencies"

workflows:
  version: 2

  # Define workflows triggered by path changes
  project_workflows:
    jobs:
      - path-filtering/filter:
          name: project1-changes
          paths:
            - "project1/**"
          trigger: project1_workflow

      - path-filtering/filter:
          name: project2-changes
          paths:
            - "project2/**"
          trigger: project2_workflow

      - path-filtering/filter:
          name: shared-changes
          paths:
            - "shared/**"
          trigger: shared_workflow

  # Define individual workflows
  project1_workflow:
    jobs:
      - build_project1

  project2_workflow:
    jobs:
      - build_project2

  shared_workflow:
    jobs:
      - build_shared
